(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{VBWd:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return b}));var r=a("wx14"),n=a("zLVn"),c=(a("q1tI"),a("7ljp")),i=a("013z"),o=(a("qKvR"),{}),s={_frontmatter:o},l=i.a;function b(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(c.b)(l,Object(r.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h2",null,"Performance and Memory Tests"),Object(c.b)("p",null,"Performance comparisons are difficult. While the goal is to do fair comparisions, you don’t want to compare horses with 1 PS cars either."),Object(c.b)("p",null,"My interpretations of the results are:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"OpenJ9 consumes less memory"),Object(c.b)("li",{parentName:"ul"},"Reactive technologies in Quarkus require less resources")),Object(c.b)("p",null,"The same endpoint is invoked 30000 times. Each invocation reads some data from a database. See below for details."),Object(c.b)("p",null,"Notes: "),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"As with every performance test your mileage will vary!"),Object(c.b)("li",{parentName:"ul"},"Again, as with every performance test your mileage will vary! "),Object(c.b)("li",{parentName:"ul"},"This is not a generic comparison of the different options. Instead I’ve tested my simple use case of the e-commerce sample application."),Object(c.b)("li",{parentName:"ul"},"I have not done any ‘tuning’ explicitly, but have used defaults. "),Object(c.b)("li",{parentName:"ul"},"Because of the many variations of runtimes, versions, JDKs, JVMs, etc. the results may not be respresentative yet. Reviews are going on."),Object(c.b)("li",{parentName:"ul"},"Please ping me if you have feedback.")),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",{parentName:"tr",align:null},"Test Case"),Object(c.b)("th",{parentName:"tr",align:"center"},"Duration"),Object(c.b)("th",{parentName:"tr",align:"right"},"Memory - Start"),Object(c.b)("th",{parentName:"tr",align:"right"},"Memory - End"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",{parentName:"tr",align:null},"1) Quarkus/OpenJ9/Reactive"),Object(c.b)("td",{parentName:"tr",align:"center"},"0:24"),Object(c.b)("td",{parentName:"tr",align:"right"},"70"),Object(c.b)("td",{parentName:"tr",align:"right"},"111")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",{parentName:"tr",align:null},"2) Quarkus/Hotspot/Reactive"),Object(c.b)("td",{parentName:"tr",align:"center"},"0:24"),Object(c.b)("td",{parentName:"tr",align:"right"},"192"),Object(c.b)("td",{parentName:"tr",align:"right"},"380")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",{parentName:"tr",align:null},"3) OpenLiberty/OpenJ9/Synch"),Object(c.b)("td",{parentName:"tr",align:"center"},"0:38"),Object(c.b)("td",{parentName:"tr",align:"right"},"149"),Object(c.b)("td",{parentName:"tr",align:"right"},"194")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",{parentName:"tr",align:null},"4) Quarkus/OpenJ9/Synch"),Object(c.b)("td",{parentName:"tr",align:"center"},"0:58"),Object(c.b)("td",{parentName:"tr",align:"right"},"85"),Object(c.b)("td",{parentName:"tr",align:"right"},"145")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",{parentName:"tr",align:null},"5) Quarkus/Native/Reactive"),Object(c.b)("td",{parentName:"tr",align:"center"},"0:27"),Object(c.b)("td",{parentName:"tr",align:"right"},"11"),Object(c.b)("td",{parentName:"tr",align:"right"},"378")))),Object(c.b)("h3",null,"Test Case 1: Quarkus - JVM Mode - OpenJ9 - Reactive"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Quarkus (directory: ",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/tree/master/service-catalog-quarkus-reactive"},"service-catalog-quarkus-reactive"),")"),Object(c.b)("li",{parentName:"ul"},"Image: adoptopenjdk/openjdk11-openj9:ubi-minimal - ",Object(c.b)("a",{parentName:"li",href:"../service-catalog-quarkus-reactive/Dockerfile"},"Dockerfile")),Object(c.b)("li",{parentName:"ul"},"Reactive Postgres (",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/blob/master/service-catalog-quarkus-reactive/src/main/java/com/ibm/catalog/ProductResource.java#L46"},"example"),")"),Object(c.b)("li",{parentName:"ul"},"Postgres running in a container")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"$ git clone https://github.com/nheidloff/application-modernization-javaee-quarkus.git && cd application-modernization-javaee-quarkus\n$ ROOT_FOLDER=$(pwd)\n$ sh scripts-docker/stop-services.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run.sh\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl "http://localhost/CustomerOrderServicesWeb/jaxrs/Product/?categoryId=2"\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"docker exec storefront-catalog-reactive cat /sys/fs/cgroup/memory/memory.stat | grep rss\n")),Object(c.b)("p",null,"Results:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Duration of 30000 invocations: 0:24 mins"),Object(c.b)("li",{parentName:"ul"},"Memory before any invocations: 70 MB RSS"),Object(c.b)("li",{parentName:"ul"},"Memory after 30000 invocations: 111 MB RSS")),Object(c.b)("h3",null,"Test Case 2: Quarkus - JVM Mode - Hotspot - Reactive"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Quarkus (directory: ",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/tree/master/service-catalog-quarkus-reactive"},"service-catalog-quarkus-reactive"),")"),Object(c.b)("li",{parentName:"ul"},"Image: fabric8/java-alpine-openjdk11-jre - ",Object(c.b)("a",{parentName:"li",href:"../service-catalog-quarkus-reactive/Dockerfile.hotspot"},"Dockerfile")),Object(c.b)("li",{parentName:"ul"},"Reactive Postgres (",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/blob/master/service-catalog-quarkus-reactive/src/main/java/com/ibm/catalog/ProductResource.java#L46"},"example"),")"),Object(c.b)("li",{parentName:"ul"},"Postgres running in a container")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"$ git clone https://github.com/nheidloff/application-modernization-javaee-quarkus.git && cd application-modernization-javaee-quarkus\n$ ROOT_FOLDER=$(pwd)\n$ sh scripts-docker/stop-services.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-hotspot.sh\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl "http://localhost/CustomerOrderServicesWeb/jaxrs/Product/?categoryId=2"\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"docker exec storefront-catalog-reactive cat /sys/fs/cgroup/memory/memory.stat | grep rss\ndocker exec storefront-catalog-reactive ps -o rss,vsz 1 \n")),Object(c.b)("p",null,"Results:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Duration of 30000 invocations: 0:24 mins"),Object(c.b)("li",{parentName:"ul"},"Memory before any invocations: 192 MB RSS"),Object(c.b)("li",{parentName:"ul"},"Memory after 30000 invocations: 380 MB RSS")),Object(c.b)("h3",null,"Test Case 3: Open Liberty - OpenJ9 - Synchronous"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Open Liberty (directory: ",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/tree/master/monolith-open-liberty-cloud-native"},"monolith-open-liberty-cloud-native"),")"),Object(c.b)("li",{parentName:"ul"},"Image: open-liberty:kernel-java11-openj9-ubi - ",Object(c.b)("a",{parentName:"li",href:"../monolith-open-liberty-cloud-native/Dockerfile.multistage"},"Dockerfile")),Object(c.b)("li",{parentName:"ul"},"JPA - synchronous (",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/blob/master/monolith-open-liberty-cloud-native/src/main/java/org/pwte/example/service/ProductSearchServiceImpl.java#L30"},"example"),")"),Object(c.b)("li",{parentName:"ul"},"Db2 running in a container")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"$ git clone https://github.com/nheidloff/application-modernization-javaee-quarkus.git && cd application-modernization-javaee-quarkus\n$ ROOT_FOLDER=$(pwd)\n$ sh scripts-docker/stop-services.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-monolith-db2.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-database-postgres-catalog.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-kafka.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-catalog.sh\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl "http://localhost:9088/CustomerOrderServicesWeb/jaxrs/Product/?categoryId=2"\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"docker exec storefront-backend-open-native cat /sys/fs/cgroup/memory/memory.stat | grep rss\n")),Object(c.b)("p",null,"Results:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Duration of 30000 invocations:  0:38 mins"),Object(c.b)("li",{parentName:"ul"},"Memory before any invocations:   149 MB RSS"),Object(c.b)("li",{parentName:"ul"},"Memory after 30000 invocations:  194 MB RSS")),Object(c.b)("h3",null,"Test Case 4: Quarkus - JVM Mode - OpenJ9 - Synchronous"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Quarkus (directory: ",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/tree/master/service-catalog-quarkus-synch"},"service-catalog-quarkus-synch"),")"),Object(c.b)("li",{parentName:"ul"},"Image: adoptopenjdk/openjdk11-openj9:ubi-minimal - ",Object(c.b)("a",{parentName:"li",href:"../service-catalog-quarkus-synch/Dockerfile"},"Dockerfile")),Object(c.b)("li",{parentName:"ul"},"Panache - synchronous (",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/blob/master/service-catalog-quarkus-synch/src/main/java/com/ibm/catalog/CategoryResource.java#L29"},"example"),")"),Object(c.b)("li",{parentName:"ul"},"Postgres running in a container")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"$ git clone https://github.com/nheidloff/application-modernization-javaee-quarkus.git && cd application-modernization-javaee-quarkus\n$ ROOT_FOLDER=$(pwd)\n$ sh scripts-docker/stop-services.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-monolith-db2.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-database-postgres-catalog.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-kafka.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-catalog.sh\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl "http://localhost/CustomerOrderServicesWeb/jaxrs/Product/?categoryId=2"\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"docker exec storefront-catalog cat /sys/fs/cgroup/memory/memory.stat | grep rss\n")),Object(c.b)("p",null,"Results:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Duration of 30000 invocations:  1:01 mins"),Object(c.b)("li",{parentName:"ul"},"Memory before any invocations:  85 MB RSS"),Object(c.b)("li",{parentName:"ul"},"Memory after 30000 invocations: 145 MB RSS")),Object(c.b)("h3",null,"Test Case 5: Quarkus - Native Mode - Reactive"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Quarkus (directory: ",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/tree/master/service-catalog-quarkus-reactive"},"service-catalog-quarkus-reactive"),")"),Object(c.b)("li",{parentName:"ul"},"Image: registry.access.redhat.com/ubi8/ubi-minimal - ",Object(c.b)("a",{parentName:"li",href:"../service-catalog-quarkus-reactive/src/main/docker/Dockerfile"},"Dockerfile")),Object(c.b)("li",{parentName:"ul"},"Reactive Postgres (",Object(c.b)("a",{parentName:"li",href:"https://github.com/nheidloff/application-modernization-javaee-quarkus/blob/master/service-catalog-quarkus-reactive/src/main/java/com/ibm/catalog/ProductResource.java#L46"},"example"),")"),Object(c.b)("li",{parentName:"ul"},"Postgres running in a container")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"$ git clone https://github.com/nheidloff/application-modernization-javaee-quarkus.git && cd application-modernization-javaee-quarkus\n$ ROOT_FOLDER=$(pwd)\n$ sh scripts-docker/stop-services.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-monolith-db2.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-database-postgres-catalog.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/run-kafka.sh\n$ sh ${ROOT_FOLDER}/scripts-docker/build-and-run-quarkus-services.sh\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl "http://localhost/CustomerOrderServicesWeb/jaxrs/Product/?categoryId=2"\n')),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"docker exec storefront-catalog-reactive cat /sys/fs/cgroup/memory/memory.stat | grep rss\n")),Object(c.b)("p",null,"Results:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Duration of 30000 invocations:   0:26 mins"),Object(c.b)("li",{parentName:"ul"},"Memory before any invocations:   11 MB RSS"),Object(c.b)("li",{parentName:"ul"},"Memory after 30000 invocations:  378 MB RSS")))}b.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-applications-refactor-images-performance-md-269e28380f1e678faa07.js.map